<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <!-- Meta, title, CSS, favicons, etc. -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Cache-control" content="public">
  <title>
    <%= title %>
  </title>
  <!-- Custom Theme Style -->
  <style type="text/css">
    body {
      color: #393F44;
      background: #ECECEC;
      font-family: "Helvetica Neue", Roboto, Arial, "Droid Sans", sans-serif;
      font-size: 13px;
      font-weight: 400;
      line-height: 1.471;
    }

    .main_container {
      padding: 10px 20px 0;
    }

    i span {
      display: none;
    }

    /* Table */
    table {
      width: 850px;
      padding: 1px;
      margin-top: 25px;
      border-bottom: 1px solid;
      border-color: #84a6bb;
    }

    th,
    td {
      border-color: #84a6bb;
    }

    tr:nth-child(odd) {
      background-color: #eee;
    }

    tr:nth-child(even) {
      color: #eee;
      background-color: #3a4e59;
    }

    tr:nth-child(even) code {
      font-size: 9.5px;
      font-family: monospace;
      color: #ddd;
      line-height: 1.2em;
      page-break-inside: avoid;
      word-wrap: break-word;
      overflow-x: auto;
    }

    tr:nth-child(even) a {
      color: #8992FF;
    }

    code {
      font-size: 9.5px;
      font-family: monospace;
      color: #2e404d;
      line-height: 1.2em;
      page-break-inside: avoid;
      word-wrap: break-word;
      overflow-x: auto;
    }

    .tc_detail {
      font-size: 11.5px;
    }

    /* colors */
    .ambiguous-color {
      color: #E74C3C !important;
    }

    .failed-color {
      color: #E74C3C !important;
    }

    .not-defined-color {
      color: #F39C12 !important;
    }

    .passed-color {
      color: #1ABB9C !important;
    }

    .pending-color {
      color: #FFD119 !important;
    }

    .skipped-color {
      color: #3498DB !important;
    }

    /* backgrounds */
    .ambiguous-background {
      background: #b73122 !important;
    }

    .failed-background {
      background: #E74C3C !important;
    }

    .not-defined-background {
      background: #F39C12 !important;
    }

    .passed-background {
      background: #1ABB9C !important;
    }

    .pending-background {
      background: #FFD119 !important;
    }

    .skipped-background {
      background: #3498DB !important;
    }

    .meter {
      height: 20px;
      position: relative;
      background: #E74C3C;
      box-shadow: inset 0 -1px 1px rgba(255, 255, 255, 0.3);
      max-width: 450px;
    }

    .meter>span {
      display: block;
      height: 100%;
      background-color: #1ABB9C;
      background-image: linear-gradient(center bottom,
          rgb(26, 187, 134) 37%,
          rgb(45, 215, 159) 69%);
      box-shadow:
        inset 0 2px 9px rgba(255, 255, 255, 0.3),
        inset 0 -2px 6px rgba(0, 0, 0, 0.4);
      position: relative;
      overflow: hidden;
    }
  </style>
</head>

<body>
  <p>Hi all,</p>
  <p>Below are the results from the <%= service %> Automation Regression Daily Run on
    <strong>
      <%= date %>
    </strong>
  </p>
  <p>Pipeline Execution Trends on
    <a href="<%= dashboardUrl %>" target="_blank">
      <% service %> Pipeline Execution Dashboard
    </a>
  </p>

  <h2>
    <%= title %>
  </h2>
  <div>
    <a title="<%= pipelineExecutionNumber %>" href="<%= pipelineExecutionUrl %>" target="_blank">
      Pipeline Execution #<%= pipelineExecutionNumber %></a>
  </div>
  <!-- <div>
    <img src="data:image/png;base64,<%= imageB64 %>" alt="" />
  </div> -->
  <div>
    <br>
    Results: <strong><%= passedCount +failedCount %></strong> Total
    <br>
    ✅ Passed:
    <span class="passed-color">
      <strong><%= passedCount %></strong>
      &nbsp;&nbsp;&nbsp;
      (<%= parseInt(parseFloat((passedCount*100)/(passedCount+failedCount)).toFixed(1)) %>%)
    </span>
    <br>
    ❌ Failed:
    <span class="failed-color">
      <strong><%= failedCount %></strong>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      (<%= parseInt(parseFloat((failedCount*100)/(passedCount+failedCount)).toFixed(1)) %>%)
    </span>
  </div>

  <div class="meter">
    <span style="width: <%= (passedCount*100)/(passedCount+failedCount) %>%;"></span>
  </div>

  <% if ( errors.length> 0 ) { %>
  <div id="failures_detail_table">
    <table>
      <tr>
        <th colspan="5">Failed test cases detail</th>
      </tr>
      <tr>
        <th>#</th>
        <th>Feature</th>
        <th>Scenario</th>
        <th>Associated bugs</th>
        <th>Details</th>
      </tr>

      <% for (let index=0; index < errors.length; index ++) { %>
      <tr>
        <td rowspan="4">
          <%= index + 1 %>
        </td>
        <td rowspan="4">
          <%= errors[index]['feature'] %>
        </td rowspan="4">
        <td rowspan="4">
          <%= errors[index]['scenario'] %>
        </td>

        <td rowspan="4">
          <% if (errors[index]['bugTags'].length> 0) { %>
            <% for (let bindex=0; bindex < errors[index]['bugTags'].length; bindex++) { %>
              <a target="_blank" href="<%= errors[index]['bugTags'][bindex]['url'] %>">
                #<%= errors[index]['bugTags'][bindex]['name'] %>
                <%= (errors[index]['bugTags'][bindex]['state']) %>
              </a> &nbsp;
            <% } %>
          <% } else { %>
          <% } %>
        </td>
      </tr>

      <tr>
        <td>
          <span class="tc_detail">
            <strong>Step:</strong>
            <%= errors[index]['keyword'] %>
            <%= errors[index]['stepName'] %>
          </span>
        </td>
      </tr>
      <tr>
        <td>
          <span class="tc_detail"><strong>Error:</strong></span>
          <code><%= errors[index]['error'].substring(0, 105) %>...</code>
        </td>
      </tr>
      <tr>
        <td>
          <!-- To put additional notes -->
          &nbsp;&nbsp;
        </td>
      </tr>

      <% } %>
    </table>
  </div>
  <% } %>
  <br>
  <div>
    <div>Reply is not necessary.</div>
    <div>Regards</div>
    <div>
      <%= service %> Automation Team
    </div>
  </div>

</body>

</html>